This code was written by Michael Chambers and Coldan Barr